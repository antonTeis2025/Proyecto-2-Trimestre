<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Panel de Administrador</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

<div th:replace="~{layout :: menu}"></div>

<div class="max-w-6xl mx-auto px-6 py-8">

    <h2 class="text-2xl font-semibold mb-6">
        Panel de Administrador
    </h2>

    <div th:if="${param.success}" class="mb-4">
        <p class="text-green-700 bg-green-100 border border-green-300 px-4 py-2 rounded"
           th:text="${param.success[0]}"></p>
    </div>

    <div th:if="${param.error}" class="mb-4">
        <p class="text-red-700 bg-red-100 border border-red-300 px-4 py-2 rounded"
           th:text="${param.error[0]}"></p>
    </div>

    <div class="bg-white border border-gray-300 rounded p-6">

        <h3 class="text-lg font-semibold mb-4">
            Gestión de Usuarios
        </h3>

        <div class="mb-4 flex gap-4 text-sm">
            <a href="/web/administrador/crear-usuario"
               class="text-blue-600 hover:text-blue-800 underline">
                Crear nuevo usuario
            </a>
            <a href="/web/administrador/cargar-usuarios"
               class="text-blue-600 hover:text-blue-800 underline">
                Importar usuarios
            </a>
        </div>

        <div class="overflow-x-auto">
            <table class="w-full border border-gray-300 text-sm">
                <thead class="bg-gray-100">
                <tr>
                    <th class="border border-gray-300 px-3 py-2 text-left">ID</th>
                    <th class="border border-gray-300 px-3 py-2 text-left">Nombre</th>
                    <th class="border border-gray-300 px-3 py-2 text-left">Apellidos</th>
                    <th class="border border-gray-300 px-3 py-2 text-left">Username</th>
                    <th class="border border-gray-300 px-3 py-2 text-left">Rol</th>
                    <th class="border border-gray-300 px-3 py-2 text-left">Estado</th>
                    <th class="border border-gray-300 px-3 py-2 text-left">Acciones</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="usuario : ${usuarios}" class="hover:bg-gray-50">
                    <td class="border border-gray-300 px-3 py-2"
                        th:text="${usuario.id}"></td>
                    <td class="border border-gray-300 px-3 py-2"
                        th:text="${usuario.nombre}"></td>
                    <td class="border border-gray-300 px-3 py-2"
                        th:text="${usuario.apellidos}"></td>
                    <td class="border border-gray-300 px-3 py-2"
                        th:text="${usuario.username}"></td>
                    <td class="border border-gray-300 px-3 py-2">
                        <span th:if="${usuario.rol == 'Usuario'}">Usuario</span>
                        <span th:if="${usuario.rol == 'Tecnico'}">Técnico</span>
                        <span th:if="${usuario.rol == 'Administrador'}">Administrador</span>
                    </td>
                    <td class="border border-gray-300 px-3 py-2">
                        <span th:if="${usuario.alta}"
                              class="text-green-700 font-medium">
                            Activo
                        </span>
                        <span th:if="${!usuario.alta}"
                              class="text-red-700 font-medium">
                            Inactivo
                        </span>
                    </td>
                    <td class="border border-gray-300 px-3 py-2 space-y-1">

                        <a th:href="@{/web/administrador/editar-usuario/{id}(id=${usuario.id})}"
                           class="text-blue-600 hover:text-blue-800 underline block">
                            Editar
                        </a>

                        <a th:href="@{/web/administrador/cambiar-contrasinal/{id}(id=${usuario.id})}"
                           class="text-blue-600 hover:text-blue-800 underline block">
                            Cambiar credenciales
                        </a>

                        <form th:if="${usuario.alta}"
                              th:action="@{/web/administrador/dar-baja/{id}(id=${usuario.id})}"
                              method="post"
                              class="inline">
                            <button type="submit"
                                    class="text-red-600 hover:text-red-800 underline">
                                Dar de baja
                            </button>
                        </form>

                        <form th:if="${!usuario.alta}"
                              th:action="@{/web/administrador/reactivar/{id}(id=${usuario.id})}"
                              method="post"
                              class="inline">
                            <button type="submit"
                                    class="text-green-600 hover:text-green-800 underline">
                                Reactivar
                            </button>
                        </form>

                    </td>
                </tr>
                </tbody>
            </table>
        </div>

    </div>

</div>

<div th:replace="~{layout :: footer}"></div>

</body>
</html>
